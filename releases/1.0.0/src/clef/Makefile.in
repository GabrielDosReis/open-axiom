# this is where the include files live
INC=    $(axiom_src_srcdir)/include

bin_PROGRAMS = clef$(EXEEXT)

clef_sources = edible.c

clef_SOURCES = $(addsuffix .pamphlet, $(clef_sources))

clef_objects = $(clef_sources:.c=.lo)

clef_LDADD = $(axiom_target_libdir)/libspad.la
clef_DEPENDENCIES =

subdir = src/clef/

pamphlets = $(clef_SOURCES) Makefile.pamphlet

.PHONY: all all-clef
all: all-ax

all-ax all-clef: stamp
	@ echo finished $(builddir)

stamp: $(axiom_target_bindir)/clef$(EXEEXT)
	@rm -f stamp
	$(STAMP) stamp

$(axiom_target_bindir)/clef$(EXEEXT): $(clef_objects) $(clef_DEPENDENCIES)
	$(LINK) -o $@ $(clef_objects) $(clef_LDADD) ${LDF}

.SUFFIXES:
.SUFFIXES: .c .lo .h
.PRECIOUS: %.c
.PRECIOUS: %.lo

%.c: $(srcdir)/%.c.pamphlet
	$(axiom_build_document) --tangle --output=$@ $<

%.lo: ${INC}/useproto.h ${INC}/edible.h \
	$(axiom_configdir)/axiom-c-macros.h

%.lo: %.c $(axiom_c_macros_h)
	$(COMPILE) -o $@ ${CCF} $(axiom_includes) $<

mostlyclean-local:
	@rm -f $(clef_objects)
	@rm -f $(clef_sources)
	@rm -f stamp

clean-local: mostlyclean-local
	@rm -f $(axiom_target_bindir)/clef$(EXEEXT)

distclean-local: clean-local

